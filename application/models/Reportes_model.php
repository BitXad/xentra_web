<?php
/* 
 * Generated by CRUDigniter v3.2 
 * www.crudigniter.com
 */
 
class Reportes_model extends CI_Model
{
    function __construct()
    {
        parent::__construct();
    }
    
    /*
     * Get multum by id_multa
     */
    function get_direcciones()
    {

        $sql = "SELECT a.direccion_asoc AS 'direccion', SUM(l.consumo_lec) as 'consumo', SUM(dg.total_detfact) as 'agua', SUM(dl.total_detfact) as 'alcantarillado' FROM lectura l
LEFT JOIN asociado a on a.`id_asoc`=l.`id_asoc`
LEFT JOIN factura f on l.`id_lec`=f.`id_lec`
LEFT JOIN detalle_factura dg on f.`id_fact`=dg.`id_fact`
LEFT JOIN detalle_factura dl on f.`id_fact`=dl.`id_fact`
WHERE dg.descip_detfact='CONSUMO DE AGUA POTABLE'
      and dl.descip_detfact='SERVICIO DE ALCANTARILLADO'
GROUP BY direccion";
        $direcciones = $this->db->query($sql)->result_array();

        return $direcciones;
    }
    function reporte_mensual()
    {
        $multa = $this->db->query("
            SELECT
                *

            FROM
                `multa`

            WHERE
                1 = 1

            ORDER BY `id_multa` DESC
        ")->result_array();

        return $multa;
    }
    
}
